datasource db {
    provider          = "sqlserver"
    url               = env("DATABASE_URL")
    shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id          String   @id @default(uuid())
    pubkey      String
    identifier  String?
    isActivated Boolean
    createdAt   DateTime

    userVerifications UserVerification[]
    userRelays        UserRelay[]
    userEvents        UserEvent[]
}

model UserVerification {
    id        String   @id @default(uuid())
    userId    String
    createdAt DateTime
    expiresAt DateTime
    code      String

    user User @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

model UserRelay {
    id      String @id @default(uuid())
    userId  String
    address String

    user User @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

model UserEvent {
    id              String   @id @default(uuid())
    userId          String
    userEventTypeId Int
    createdAt       DateTime @default(now())

    user         User          @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    userEentType UserEventType @relation(fields: [userEventTypeId], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model UserEventType {
    id         Int         @id
    name       String
    userEvents UserEvent[]
}
